
template(name="impcap_darwin_object" type="string" string="{\"qname\": \"%$.name!qname%\", \"type\": \"%$.name!type%\", \"qtype\": \"%$.name!qtype%\", \"class\": \"%$.name!class%\", \"qclass\": \"%$.name!qclass%\", \"darwin_decision\": \"%$!mmdarwin!dga%\"},")

template(name="impcap" type="list" option.json="on") {
    constant(value="{")
    constant(value="\"time\": \"")             property(name="$!impcap!timestamp")
    constant(value="\", \"frontend_name\": \"")             property(name="$!frontend_name")
    constant(value="\", \"ID\": ")               property(name="$!impcap!ID")
    constant(value=", \"net_bytes_total\": ")   property(name="$!impcap!net_bytes_total")
    constant(value="\"ETH_src\": \"")           property(name="$!impcap!ETH_src")
    constant(value="\", \"ETH_dst\": \"")           property(name="$!impcap!ETH_dst")
    constant(value="\", \"ETH_tag\": \"")           property(name="$!impcap!ETH_tag")
    constant(value="\", \"ETH_len\": ")           property(name="$!impcap!ETH_len")
    constant(value=", \"ETH_type\": ")          property(name="$!impcap!ETH_type")
    constant(value="\", \"ETH_typestr\": \"")       property(name="$!impcap!ETH_typestr")
    constant(value="\", \"LLC_dsap\": \"")          property(name="$!impcap!LLC_dsap")
    constant(value="\", \"LLC_ssap\": \"")          property(name="$!impcap!LLC_ssap")
    constant(value="\", \"LLC_ctrl\": \"")          property(name="$!impcap!LLC_ctrl")
    constant(value="\", \"SNAP_oui\": \"")          property(name="$!impcap!SNAP_oui")
    constant(value="\", \"SNAP_ethType\": \"")      property(name="$!impcap!SNAP_ethType")
    constant(value="\", \"net_dst_ip\": \"")        property(name="$!impcap!net_dst_ip")
    constant(value="\", \"net_src_ip\": \"")        property(name="$!impcap!net_src_ip")
    constant(value="\", \"IP_ihl\": ")            property(name="$!impcap!IP_ihl")
    constant(value=", \"net_ttl\": ")           property(name="$!impcap!net_ttl")
    constant(value=", \"IP_proto\": \"")          property(name="$!impcap!IP_proto")
    constant(value="\", \"IPX_transCtrl\": \"")     property(name="$!impcap!IPX_transCtrl")
    constant(value="\", \"IPX_type\": \"")          property(name="$!impcap!IPX_type")
    constant(value="\", \"IPX_dest_net\": \"")      property(name="$!impcap!IPX_dest_net")
    constant(value="\", \"IPX_src_net\": \"")       property(name="$!impcap!IPX_src_net")
    constant(value="\", \"IPX_dest_node\": \"")     property(name="$!impcap!IPX_dest_node")
    constant(value="\", \"IPX_src_node\": \"")      property(name="$!impcap!IPX_src_node")
    constant(value="\", \"IPX_dest_socket\": \"")   property(name="$!impcap!IPX_dest_socket")
    constant(value="\", \"IPX_src_soket\": \"")     property(name="$!impcap!IPX_src_soket")
    constant(value="\", \"IP6_next_header\": \"")   property(name="$!impcap!IP6_next_header")
    constant(value="\", \"ARP_hwType\": \"")        property(name="$!impcap!ARP_hwType")
    constant(value="\", \"ARP_pType\": \"")         property(name="$!impcap!ARP_pType")
    constant(value="\", \"ARP_op\": \"")            property(name="$!impcap!ARP_op")
    constant(value="\", \"ARP_hwSrc\": \"")         property(name="$!impcap!ARP_hwSrc")
    constant(value="\", \"ARP_hwDst\": \"")         property(name="$!impcap!ARP_hwDst")
    constant(value="\", \"ARP_pSrc\": \"")          property(name="$!impcap!ARP_pSrc")
    constant(value="\", \"ARP_pDst\": \"")          property(name="$!impcap!ARP_pDst")
    constant(value="\", \"RARP_hwType\": \"")       property(name="$!impcap!RARP_hwType")
    constant(value="\", \"RARP_pType\": \"")        property(name="$!impcap!RARP_pType")
    constant(value="\", \"RARP_op\": \"")           property(name="$!impcap!RARP_op")
    constant(value="\", \"RARP_hwSrc\": \"")        property(name="$!impcap!RARP_hwSrc")
    constant(value="\", \"RARP_hwDst\": \"")        property(name="$!impcap!RARP_hwDst")
    constant(value="\", \"RARP_pSrc\": \"")         property(name="$!impcap!RARP_pSrc")
    constant(value="\", \"RARP_pDst\": \"")         property(name="$!impcap!RARP_pDst")
    constant(value="\", \"net_icmp_type\": ")     property(name="$!impcap!net_icmp_type")
    constant(value=", \"net_icmp_code\": ")     property(name="$!impcap!net_icmp_code")
    constant(value=", \"icmp_checksum\": ")     property(name="$!impcap!icmp_checksum")
    constant(value=", \"net_src_port\": ")      property(name="$!impcap!net_src_port")
    constant(value=", \"net_dst_port\": ")      property(name="$!impcap!net_dst_port")
    constant(value=", \"TCP_seq_number\": ")    property(name="$!impcap!TCP_seq_number")
    constant(value=", \"TCP_ack_number\": ")    property(name="$!impcap!TCP_ack_number")
    constant(value=", \"TCP_data_length\": ")   property(name="$!impcap!TCP_data_length")
    constant(value=", \"net_flags\": \"")         property(name="$!impcap!net_flags")
    constant(value="\", \"UDP_Length\": ")        property(name="$!impcap!UDP_Length")
    constant(value=", \"UDP_Checksum\": ")      property(name="$!impcap!UDP_Checksum")
    constant(value=", \"DNS_transaction_id\": ")property(name="$!impcap!DNS_transaction_id")
    constant(value=", \"DNS_response_flag\": ") property(name="$!impcap!DNS_response_flag")
    constant(value=", \"DNS_opcode\": ")        property(name="$!impcap!DNS_opcode")
    constant(value=", \"DNS_rcode\": ")         property(name="$!impcap!DNS_rcode")
    constant(value=", \"DNS_error\": \"")         property(name="$!impcap!DNS_error")
    constant(value="\", \"DNS_QDCOUNT\": ")       property(name="$!impcap!DNS_QDCOUNT")
    constant(value=", \"DNS_ANCOUNT\": ")       property(name="$!impcap!DNS_ANCOUNT")
    constant(value=", \"DNS_NSCOUNT\": ")       property(name="$!impcap!DNS_NSCOUNT")
    constant(value=", \"DNS_ARCOUNT\": ")       property(name="$!impcap!DNS_ARCOUNT")
    constant(value=", \"DNS_Names\": \"")         property(name="$!impcap!DNS_Names")
    constant(value="\", \"SMB_version\": \"")       property(name="$!impcap!SMB_version")
    constant(value="\", \"SMB_NTstatus\": \"")      property(name="$!impcap!SMB_NTstatus")
    constant(value="\", \"SMB_operation\": \"")     property(name="$!impcap!SMB_operation")
    constant(value="\", \"SMB_flags\": \"")         property(name="$!impcap!SMB_flags")
    constant(value="\", \"SMB_seqNumber\": \"")     property(name="$!impcap!SMB_seqNumber")
    constant(value="\", \"SMB_processID\": \"")     property(name="$!impcap!SMB_processID")
    constant(value="\", \"SMB_treeID\": \"")        property(name="$!impcap!SMB_treeID")
    constant(value="\", \"SMB_userID\": \"")        property(name="$!impcap!SMB_userID")
    constant(value="\", \"FTP_request\": \"")       property(name="$!impcap!FTP_request")
    constant(value="\", \"FTP_response\": \"")      property(name="$!impcap!FTP_response")
    constant(value="\", \"HTTP_status_code\": ")  property(name="$!impcap!HTTP_status_code")
    constant(value=", \"HTTP_content_type\": \"") property(name="$!impcap!HTTP_content_type")
    constant(value="\", \"reputation\": \"")        property(name="$!iplocation!reputation")
    constant(value="\", \"geoip\": \"")             property(name="$!iplocation!geoip")
    constant(value="\", \"ctx_tags\": \"")          property(name="$!ctx_tags")
    constant(value="\", \"DNS_queries\": ")         property(name="$!impcap!DNS_queries")
    constant(value="\", \"darwin_id\": ")         property(name="$!mmdarwin!darwin_id")
    constant(value="}")
}


template(name="impcap_mongo" type="list") {
    property(name="$!impcap!timestamp" outname="time")
    property(name="$!frontend_name")
    property(name="$!impcap!ID" outname="id")
    property(name="$!impcap!net_bytes_total" outname="net_bytes_total")
    property(name="$!impcap!ETH_src" outname="ETH_src")
    property(name="$!impcap!ETH_dst" outname="ETH_dst")
    property(name="$!impcap!ETH_tag" outname="ETH_tag")
    property(name="$!impcap!ETH_len" outname="ETH_len")
    property(name="$!impcap!ETH_type" outname="ETH_type")
    property(name="$!impcap!ETH_typestr" outname="ETH_typestr")
    property(name="$!impcap!LLC_dsap" outname="LLC_dsap")
    property(name="$!impcap!LLC_ssap" outname="LLC_ssap")
    property(name="$!impcap!LLC_ctrl" outname="LLC_ctrl")
    property(name="$!impcap!SNAP_oui" outname="SNAP_oui")
    property(name="$!impcap!SNAP_ethType" outname="SNAP_ethType")
    property(name="$!impcap!net_dst_ip" outname="net_dst_ip")
    property(name="$!impcap!net_src_ip" outname="net_src_ip")
    property(name="$!impcap!IP_ihl" outname="IP_ihl")
    property(name="$!impcap!net_ttl" outname="net_ttl")
    property(name="$!impcap!IP_proto" outname="IP_proto")
    property(name="$!impcap!IPX_transCtrl" outname="IPX_transCtrl")
    property(name="$!impcap!IPX_type" outname="IPX_type")
    property(name="$!impcap!IPX_dest_net" outname="IPX_dest_net")
    property(name="$!impcap!IPX_src_net" outname="IPX_src_net")
    property(name="$!impcap!IPX_dest_node" outname="IPX_dest_node")
    property(name="$!impcap!IPX_src_node" outname="IPX_src_node")
    property(name="$!impcap!IPX_dest_socket" outname="IPX_dest_socket")
    property(name="$!impcap!IPX_src_soket" outname="IPX_src_soket")
    property(name="$!impcap!IP6_next_header" outname="IP6_next_header")
    property(name="$!impcap!ARP_hwType" outname="ARP_hwType")
    property(name="$!impcap!ARP_pType" outname="ARP_pType")
    property(name="$!impcap!ARP_op" outname="ARP_op")
    property(name="$!impcap!ARP_hwSrc" outname="ARP_hwSrc")
    property(name="$!impcap!ARP_hwDst" outname="ARP_hwDst")
    property(name="$!impcap!ARP_pSrc" outname="ARP_pSrc")
    property(name="$!impcap!ARP_pDst" outname="ARP_pDst")
    property(name="$!impcap!RARP_hwType" outname="RARP_hwType")
    property(name="$!impcap!RARP_pType" outname="RARP_pType")
    property(name="$!impcap!RARP_op" outname="RARP_op")
    property(name="$!impcap!RARP_hwSrc" outname="RARP_hwSrc")
    property(name="$!impcap!RARP_hwDst" outname="RARP_hwDst")
    property(name="$!impcap!RARP_pSrc" outname="RARP_pSrc")
    property(name="$!impcap!RARP_pDst" outname="RARP_pDst")
    property(name="$!impcap!net_icmp_type" outname="net_icmp_type")
    property(name="$!impcap!net_icmp_code" outname="net_icmp_code")
    property(name="$!impcap!icmp_checksum" outname="icmp_checksum")
    property(name="$!impcap!net_src_port" outname="net_src_port")
    property(name="$!impcap!net_dst_port" outname="net_dst_port")
    property(name="$!impcap!TCP_seq_number" outname="TCP_seq_number")
    property(name="$!impcap!TCP_ack_number" outname="TCP_ack_number")
    property(name="$!impcap!TCP_data_length" outname="TCP_data_length")
    property(name="$!impcap!net_flags" outname="net_flags")
    property(name="$!impcap!UDP_Length" outname="UDP_Length")
    property(name="$!impcap!UDP_Checksum" outname="UDP_Checksum")
    property(name="$!impcap!DNS_transaction_id" outname="DNS_transaction_id")
    property(name="$!impcap!DNS_response_flag" outname="DNS_response_flag")
    property(name="$!impcap!DNS_opcode" outname="DNS_opcode")
    property(name="$!impcap!DNS_rcode" outname="DNS_rcode")
    property(name="$!impcap!DNS_error" outname="DNS_error")
    property(name="$!impcap!DNS_QDCOUNT" outname="DNS_QDCOUNT")
    property(name="$!impcap!DNS_ANCOUNT" outname="DNS_ANCOUNT")
    property(name="$!impcap!DNS_NSCOUNT" outname="DNS_NSCOUNT")
    property(name="$!impcap!DNS_ARCOUNT" outname="DNS_ARCOUNT")
    property(name="$!impcap!DNS_Names" outname="DNS_Names")
    property(name="$!impcap!SMB_version" outname="SMB_version")
    property(name="$!impcap!SMB_NTstatus" outname="SMB_NTstatus")
    property(name="$!impcap!SMB_operation" outname="SMB_operation")
    property(name="$!impcap!SMB_flags" outname="SMB_flags")
    property(name="$!impcap!SMB_seqNumber" outname="SMB_seqNumber")
    property(name="$!impcap!SMB_processID" outname="SMB_processID")
    property(name="$!impcap!SMB_treeID" outname="SMB_treeID")
    property(name="$!impcap!SMB_userID" outname="SMB_userID")
    property(name="$!impcap!FTP_request" outname="FTP_request")
    property(name="$!impcap!FTP_response" outname="FTP_response")
    property(name="$!impcap!HTTP_status_code" outname="HTTP_status_code")
    property(name="$!impcap!HTTP_content_type" outname="HTTP_content_type")
    property(name="$!iplocation!reputation" outname="reputation")
    property(name="$!iplocation!geoip" outname="geoip")
    property(name="$!ctx_tags" outname="ctx_tags")
    property(name="$!impcap!DNS_queries" outname="DNS_queries")
    property(name="$!mmdarwin!darwin_id" outname="darwin_id")
}
